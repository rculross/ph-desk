# Time Entry Model

The Time Entry model represents single time log, used for tracking time. Theoretically, Time Entries can be associated with many models in Planhat (all except User, Metric), and can be restricted to certain models in tenant settings. For now Time Entries created via API can only be associated to the Company model, by setting the CompanyId.

## Model Fields

| Property | Required | Type | Description |
|----------|----------|------|-------------|
| _id |  | objectId | Planhat identifier |
| companyId |  | objectId | Company id (planhat identifier). If time entry is tracked on model that is not company, this field is autofilled if model is related to company |
| date | Yes | string | Date when time was logged in ISO format |
| hours | Yes | number | The total hours logged, must be positive, can be a decimal number, and between 0.1 and 24 |
| isTimeOff |  | boolean | Indicates if the time entry is a time off (vacation, sick leave, etc) |
| description |  | string | Description of the time entry |
| isBillable |  | boolean | Indicates if the time entry is billable |
| billingCode |  | string | Billing code for the time entry if it is billable |
| currency |  | string | The currency code, for example "USD". There is a "soft" mapping to the id's in your list of currencies. Technically we accept any string but we recommend using standard currency codes as Ids. Since the mapping is soft you can add time entries with a currency code not yet available in your list of currencies |
| billableRate |  | number | Billable rate for the time entry |
| totalBilled |  | number | The total amount billed for the time entry (hours * billableRate). Calculated automatically |
| costRate |  | number | Cost rate for the time entry |
| totalCost |  | number | The total cost for the time entry (hours * costRate). Calculated automatically |
| timesheetStatus |  | string | Status of the time entry in the timesheet. Possible values are: "draft", "submitted", "approved", "returned". Default is "draft". It's readonly field. (Autogenerated) |
| timesheetId |  | objectId | Related timesheet id (planhat identifier), exists only if the time entry belongs to timesheet. It's readonly field. (Autogenerated) |
| assignedModel |  | string | Model which the Time Entry is assigned to. Current supported value is "User" |
| assignedId |  | objectId | Id of which the Time Entry is assigned to. Currently only supports User Ids |

## POST Create Time Entry

Create a time entry by defining the required fields: date and hours. Keep in mind that the hours must be positive, can be a decimal number, and between 0.1 and 24.

### Endpoint Details
- **URL:** `POST /timeentries`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request POST 'https://api.planhat.com/timeentries' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}' \
--data-raw '{
  "hours": 5,
  "date": "2025-01-30T14:51:01.691Z",
  "description": "Worked on the integration issue"
}'
```

### Example Response

```json
{
  "timesheetStatus": "draft",
  "assignedModel": "User",
  "_id": "67d04352557181002fd16424",
  "hours": 5,
  "date": "2025-01-30T00:00:00.000Z",
  "description": "Worked on the integration issue",
  "path": [],
  "totalBilled": 0,
  "totalCost": 0,
  "createdAt": "2025-03-11T14:06:10.722Z",
  "updatedAt": "2025-03-11T14:06:10.722Z",
  "__v": 0
}
```

## GET Single Time Entry

Retrieve a specific time entry by its ID.

### Endpoint Details
- **URL:** `GET /timeentries/{id}`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request GET 'https://api.planhat.com/timeentries/67d04352557181002fd16424' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}'
```

### Example Response

```json
{
  "_id": "67d04352557181002fd16424",
  "timesheetStatus": "draft",
  "assignedModel": "User",
  "hours": 7,
  "date": "2025-01-30T00:00:00.000Z",
  "description": "Worked on the integration issue",
  "path": [],
  "totalBilled": 0,
  "totalCost": 0,
  "createdAt": "2025-03-11T14:06:10.722Z",
  "updatedAt": "2025-03-11T16:50:26.953Z",
  "__v": 0
}
```

## GET Multiple Time Entries

Retrieve a list of time entries with optional filtering and pagination.

### Endpoint Details
- **URL:** `GET /timeentries`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)
- **Max Results:** 2,000 time entries per request

### Query Parameters
- `companyId` - Filter using company id
- `limit` - Limit the list length. Default: 100, Max: 2,000
- `offset` - Start the list on a specific integer index
- `sort` - Sort based on a specific property. Prefix the property with "-" to change the sort order
- `select` - Select specific properties. Multiple properties can be specified separating them by commas

### Example Request

```bash
curl --location --request GET 'https://api.planhat.com/timeentries?limit=2&offset=0&sort=-createdAt&select=_id,hours,date' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}'
```

### Example Response

```json
[
  {
    "_id": "67d04352557181002fd16424",
    "hours": 7,
    "date": "2025-01-30T00:00:00.000Z"
  },
  {
    "_id": "67c98759b874ce002f97cb48",
    "date": "2025-03-06T00:00:00.000Z",
    "hours": 12
  }
]
```

## PUT Update Time Entry

Update an existing time entry by passing the time entry _id in the request URL as a parameter.

### Endpoint Details
- **URL:** `PUT /timeentries/{id}`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request PUT 'https://api.planhat.com/timeentries/610411d5b046afb2109df12c' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}' \
--data-raw '{
  "hours": 7
}'
```

### Example Response

```json
{
  "_id": "67d04352557181002fd16424",
  "timesheetStatus": "draft",
  "assignedModel": "User",
  "hours": 7,
  "date": "2025-01-30T00:00:00.000Z",
  "description": "Worked on the integration issue",
  "path": [],
  "totalBilled": 0,
  "totalCost": 0,
  "createdAt": "2025-03-11T14:06:10.722Z",
  "updatedAt": "2025-03-11T16:50:26.953Z",
  "__v": 0
}
```

## PUT Bulk Upsert Time Entries

Bulk create and/or update multiple time entries. To create a time entry it's required to define hours and date. To update a time entry it is required to specify _id in the payload.

### Endpoint Details
- **URL:** `PUT /timeentries`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)
- **Max Items:** 5,000 time entries per request

### Example Request

```bash
curl --location --request PUT 'https://api.planhat.com/timeentries' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}' \
--data-raw '[
  {
    "_id": "677427729c28f8015843e87d",
    "hours": 6
  },
  {
    "_id": "677427729c28f8015843e87e",
    "description": "There is a problem with our integration settings that is affecting some users."
  },
  {
    "hours": 10,
    "date": "2025-01-30T14:51:01.691Z",
    "description": "Creating time entry using bulk operations"
  }
]'
```

### Example Response

```json
{
  "created": 1,
  "createdErrors": [],
  "insertsKeys": [
    {
      "_id": "67d070dc557181002fd16c9d"
    }
  ],
  "updated": 0,
  "updatedErrors": [],
  "updatesKeys": [],
  "nonupdates": 2,
  "modified": [],
  "upsertedIds": [
    "67d070dc557181002fd16c9d"
  ],
  "permissionErrors": [],
  "validationErrors": []
}
```

## POST Duplicate Time Entries

Duplicate time entries by passing the ids array in the payload. Bulk upsert will be performed on the time entries with the specified ids if ids exist.

### Endpoint Details
- **URL:** `POST /timeentries/duplicate`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request POST 'https://api.planhat.com/timeentries/duplicate' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}' \
--data-raw '{
  "ids": ["67d07487557181002fd16d50", "677427729c28f8015843e87d", "677427729c28f8015843e87e"]
}'
```

## DELETE Time Entry

Delete a time entry by passing the _id in the request URL as a parameter.

### Endpoint Details
- **URL:** `DELETE /timeentries/{id}`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request DELETE 'https://api.planhat.com/timeentries/67d04352557181002fd16424' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}'
```

---

# Timesheet Model

The Timesheet model represents a collection of time entries for a user, used for tracking time.

## Model Fields

| Property | Required | Type | Description |
|----------|----------|------|-------------|
| _id |  | objectId | Planhat identifier |
| approvedBy |  | objectId | User who approved the timesheet |
| status |  | string | Status of the timesheet. Possible values are: "submitted", "approved", "returned". Default is "submitted" |
| timeEntries |  | array | Array of time entries associated with the timesheet |
| dateOfApproval |  | string | Date when the timesheet was approved |
| dateFrom |  | number | Start date of the timesheet period. Number of days since 1970-01-01 |
| dateTo |  | number | End date of the timesheet period. Number of days since 1970-01-01 |
| assignedModel |  | string | Model which the Timesheet is assigned to. Current supported value is "User" |
| assignedId |  | objectId | Id of which the Timesheet is assigned to. Currently only supports User Ids |

## POST Create Timesheet

Create a timesheet with no required fields. The timesheet will be created with the status "submitted", but the date range should be provided in the request body.

### Endpoint Details
- **URL:** `POST /timesheets`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request POST 'https://api.planhat.com/timesheets' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}' \
--data-raw '{
  "timeEntries": [
    {
      "_id": "67d07487557181002fd16d50"
    },
    {
      "_id": "67d07694557181002fd16e1e"
    }
  ],
  "assignedId": "66eb28a6ef8857a5097fbce3",
  "assignedModel": "User",
  "dateFrom": 20156,
  "dateTo": 20163
}'
```

### Example Response

```json
{
  "timeEntries": [
    "67d07487557181002fd16d50",
    "67d07694557181002fd16e1e"
  ],
  "status": "submitted",
  "assignedModel": "User",
  "_id": "67d078fe557181002fd16f3e",
  "assignedId": "66eb28a6ef8857a5097fbce3",
  "dateFrom": 20156,
  "dateTo": 20163,
  "createdAt": "2025-03-11T17:55:10.313Z",
  "updatedAt": "2025-03-11T17:55:10.313Z",
  "__v": 0
}
```

## GET Single Timesheet

Retrieve a specific timesheet by its ID.

### Endpoint Details
- **URL:** `GET /timesheets/{id}`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request GET 'https://api.planhat.com/timesheets/67aca36fa8ba08053dee2ebf' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}'
```

### Example Response

```json
{
  "_id": "67aca36fa8ba08053dee2ebf",
  "timeEntries": [
    "67aca36ea8ba08053dee2e73",
    "67aca36ea8ba08053dee2e74",
    "67aca36ea8ba08053dee2e75"
  ],
  "status": "submitted",
  "assignedModel": "User",
  "assignedId": "66eb28a6ef8857a5097fbce3",
  "dateFrom": 20128,
  "dateTo": 20135,
  "createdAt": "2025-02-12T13:34:39.353Z",
  "updatedAt": "2025-02-12T13:34:39.353Z",
  "__v": 0
}
```

## GET Multiple Timesheets

Retrieve a list of timesheets with optional filtering and pagination.

### Endpoint Details
- **URL:** `GET /timesheets`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)
- **Max Results:** 2,000 timesheets per request

### Query Parameters
- `limit` - Limit the list length. Default: 100, Max: 2,000
- `offset` - Start the list on a specific integer index
- `sort` - Sort based on a specific property. Prefix the property with "-" to change the sort order
- `select` - Select specific properties. Multiple properties can be specified separating them by commas

### Example Request

```bash
curl --location --request GET 'https://api.planhat.com/timesheets?limit=2&offset=0&select=_id,dateFrom,dateTo' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}'
```

### Example Response

```json
[
  {
    "_id": "679a8fe00a84a200cd465542",
    "dateFrom": 20107,
    "dateTo": 20114
  },
  {
    "_id": "67a266e7c3074c019778e17c",
    "dateFrom": 20121,
    "dateTo": 20128
  }
]
```

## PUT Update Timesheet

Update an existing timesheet by passing the timesheet _id in the request URL as a parameter.

### Endpoint Details
- **URL:** `PUT /timesheets/{id}`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request PUT 'https://api.planhat.com/timesheets/67d078fe557181002fd16f3e' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}' \
--data-raw '{
  "status": "approved"
}'
```

### Example Response

```json
{
  "_id": "67d078fe557181002fd16f3e",
  "timeEntries": [
    "67d07487557181002fd16d50",
    "67d07694557181002fd16e1e"
  ],
  "status": "approved",
  "assignedModel": "User",
  "assignedId": "66eb28a6ef8857a5097fbce3",
  "dateFrom": 20159,
  "dateTo": 20165,
  "createdAt": "2025-03-11T17:55:10.313Z",
  "updatedAt": "2025-03-11T17:57:12.306Z",
  "__v": 0,
  "approvedBy": "66eb28a6ef8857a5097fbce3",
  "dateOfApproval": "2025-03-11T17:57:12.305Z"
}
```

## PUT Bulk Upsert Timesheets

Bulk create and/or update multiple timesheets. To create a timesheet, there are no required fields. To update a timesheet it is required to specify _id in the payload.

### Endpoint Details
- **URL:** `PUT /timesheets`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)
- **Max Items:** 5,000 timesheets per request

### Example Request

```bash
curl --location --request PUT 'https://api.planhat.com/timesheets' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}' \
--data-raw '[
  {
    "assignedId": "66eb28a6ef8857a5097fbce3",
    "assignedModel": "User"
  },
  {
    "_id": "67aca36fa8ba08053dee2ebf",
    "status": "returned"
  },
  {
    "_id": "67bf484af303d806b63d9a49",
    "status": "submitted"
  }
]'
```

### Example Response

```json
{
  "created": 1,
  "createdErrors": [],
  "insertsKeys": [
    {
      "_id": "67d08140557181002fd170dd"
    }
  ],
  "updated": 1,
  "updatedErrors": [],
  "updatesKeys": [
    {
      "_id": "67aca36fa8ba08053dee2ebf"
    }
  ],
  "nonupdates": 1,
  "modified": [
    "67aca36fa8ba08053dee2ebf"
  ],
  "upsertedIds": [
    "67d08140557181002fd170dd"
  ],
  "permissionErrors": [],
  "validationErrors": []
}
```

## DELETE Timesheet

Delete a timesheet by passing the _id in the request URL as a parameter.

### Endpoint Details
- **URL:** `DELETE /timesheets/{id}`
- **Authentication:** Bearer token required
- **Rate Limits:** 200 calls/minute (soft), 150 req/sec (hard)

### Example Request

```bash
curl --location --request DELETE 'https://api.planhat.com/timesheets/679a8fdd0a84a200cd4654aa' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {{apiToken}}'
```